(()=>{"use strict";const e=document.querySelector(".profile__edit-button"),t=document.querySelector(".elements"),s=(document.querySelector(".profile__name"),document.querySelector(".profile__description"),document.querySelector(".popup_type_profile-edit"),document.querySelector(".profile__add-button")),n=document.querySelector(".popup__input_is_name"),i=document.querySelector(".popup__input_is_job");class r{constructor(e,t,s,n){this._name=e,this._link=t,this._cardSelector=s,this._elementClickHandler=n}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}generateCard(){return this._element=this._getTemplate(),this._element.querySelector(".card__image").alt=this._name,this._element.querySelector(".card__image").src=this._link,this._element.querySelector(".card__title").textContent=this._name,this._setEventListeners(),this._element}_deleteCard(){this._element.remove(),this._element=null}_likeCard(){this._element.querySelector(".card__like-button").classList.toggle("card__like-button_fill")}_setEventListeners(){this._element.querySelector(".card__like-button").addEventListener("click",(()=>{this._likeCard()})),this._element.querySelector(".element__delete").addEventListener("click",(()=>{this._deleteCard()})),this._element.querySelector(".card__image").addEventListener("click",this._elementClickHandler.bind(this))}}class o{constructor(e){this._popup=document.querySelector(e),this._closeButtonClass="popup__close",this._openedPopupClass="popup__opened",this._closeEscHandle=this._handleEscClose.bind(this)}open(){this._popup.classList.add(this._openedPopupClass),document.addEventListener("keydown",this._closeEscHandle)}close(){this._popup.classList.remove(this._openedPopupClass),document.addEventListener("keydown",this._closeEscHandle)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._popup.addEventListener("click",(e=>{e.target.classList.contains(this._openedPopupClass)&&this.close(),e.target.classList.contains(this._closeButtonClass)&&this.close()}))}}class l extends o{constructor(e,t){super(e),this._formSubmit=t,this.form=this._popup.querySelector(".popup__form"),this._formInputs=Array.from(this.form.querySelectorAll(".popup__input"))}_getInputValues(){const e={};return this._formInputs.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){super.setEventListeners(),this.form.addEventListener("submit",(e=>{e.preventDefault(),this._formSubmit(this._getInputValues()),this.close()}))}close(){super.close(),this.form.reset()}}const a=new class{constructor({items:e,renderer:t},s){this._items=e,this._renderer=t,this._container=document.querySelector(s)}renderInitialItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({items:[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:c},".elements");function c({name:e,link:s}){const n=function(e,t){return new r(e,t,"#element-template",u)}(e,s);t.prepend(n.generateCard())}a.renderInitialItems();const _=new class extends o{constructor(e){super(e),this._bigImageSelector=".popup__big-img",this._image=this._popup.querySelector(this._bigImageSelector),this._bigImageTitlelSelector=".popup__name-big-img",this._imageTitle=this._popup.querySelector(this._bigImageTitlelSelector)}open(e,t){super.open(),this._image.src=t,this._image.alt=e,this._imageTitle.textContent=e}}(".popup_big-size-image");function u(){_.open(this._name,this._link)}_.setEventListeners();const p=new class{constructor({userName:e,userJob:t}){this._userName=document.querySelector(e),this._userJob=document.querySelector(t)}getUserInfo(){const e={};return e.name=this._userName.textContent,e.about=this._userJob.textContent,e}setUserInfo({name:e,about:t}){this._userName.textContent=e,this._userJob.textContent=t}}({userName:".profile__name",userJob:".profile__description"}),d=new l(".popup_type_profile-edit",(e=>{p.setUserInfo(e)}));d.setEventListeners();const m=new class{constructor(e,t){this._validationConfig=e,this._formElement=t,this._buttonElement=this._formElement.querySelector(this._validationConfig.submitButtonSelector),this._inputList=Array.from(this._formElement.querySelectorAll(this._validationConfig.inputSelector))}_showInputError(e,t){this._errorElement=this._formElement.querySelector(`#${e.id}-error`),e.classList.add(this._validationConfig.inputErrorClass),this._errorElement.innerText=t,this._errorElement.classList.add(this._validationConfig.errorClass)}hideInputError(e){this._errorElement=this._formElement.querySelector(`#${e.id}-error`),e.classList.remove(this._validationConfig.inputErrorClass),this._errorElement.classList.remove(this._validationConfig.errorClass),this._errorElement.textContent=""}_checkInputValidity(e){e.validity.valid?this.hideInputError(e):this._showInputError(e,e.validationMessage)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}toggleButtonState(){this._hasInvalidInput()?(this._buttonElement.classList.add(this._validationConfig.inactiveButtonClass),this._buttonElement.setAttribute("disabled",!0)):(this._buttonElement.classList.remove(this._validationConfig.inactiveButtonClass),this._buttonElement.removeAttribute("disabled",!1))}_setEventListeners(){this.toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}({formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_invalid",inputErrorClass:"popup__field_type_error",errorClass:"error_visible"},d.form);m.enableValidation(),e.addEventListener("click",(()=>{const e=p.getUserInfo();n.value=e.name,i.value=e.about,m.toggleButtonState(),d.open()}));const h=new l(".popup_type_add-card",(({card_name_field:e,card_link_field:t})=>{const s={name:e,link:t};a.addItem(c(s))}));h.setEventListeners(),s.addEventListener("click",(()=>{h.open()}))})();